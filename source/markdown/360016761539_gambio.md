> **Wichtig**
>
> **Legacy-Modul**
>
> Das in diesem Artikel beschriebene Modul wurde als Legacy-Modul gekennzeichnet. Dies bedeutet Folgendes:
>
> - Wir entwickeln keine neue Funktionalitäten oder beheben Bugs für dieses Modul.
> - Das Modul ist in Xentral-Instanzen nicht mehr verfügbar, die nach dem 28. Sept. 2022 erstellt wurden. Dies gilt sowohl für Demo-Instanzen als auch für lizenzierte Instanzen. Solltest du als Neukunde spezielle Anforderungen haben, die nur durch dieses Modul erfüllbar wären, kontaktiere bitte unser Kundensupport-Team, um mögliche Lösungen zu besprechen.
>
> Für weitere Informationen siehe auchWarum stuft Xentral einige Module als veraltet ein (Legacy-Module) und was bedeutet das für dich?

Mit dieser Schnittstelle kannst du xentral mit Gambio verbinden, um Bestellungen von dort in xentral zu importieren und deine im Shop verkauften Artikel in Xentral zu verwalten. Die Anbindung geschieht über eine API-Schnittstelle (Shopimporter).

> **Anmerkung**
>
> Aktuell unterstützen wir beim Gambio Importer einen rudimentären Funktionsumfang. Eine Anbindung an Gambio Cloud ist nicht möglich. Ansonsten ist im Moment nur der Auftragsimport möglich, eine Artikelanlage und Lagerzahlenabgleich ist nicht möglich.

## Features der Schnittstelle

- Aufträge aus Gambio abholen
- Auftragsstatus bei Versand in Gambio umstellen inkl. Meldung Trackingnummer
- Artikel einzeln von Xentral nach Gambio oder von Gambio nach Xentral übertragen (aktuell nicht für Varianten möglich 06/21)
- Artikelkategorien sowie Artikeleigenschaften von Xentral nach Gambio übertragen (aktuell nicht für Varianten möglich 06/21)
- Lagerzahlen sowie Pseudolagerzahlen zu Gambio übertragen (aktuell nicht für Varianten möglich 06/21)

## Anbindung

### API-Zugangsdaten im Shop generieren

Zunächst musst du dir die API-Zugangsdaten für die Anbindung an xentral im jeweiligen Shop bzw. Marktplatz generieren. Wie du das machst findest du im Helpdesk in den zugehörigen Shopartikeln. Wenn du die API-Zugangsdaten hast kannst du mit dem Anlegen der Schnittstelle in xentral fortfahren.

### Schnittstelle in xentral anlegen

UnterAdministration → Shop Schnittstelle → Übersicht → NEUkannst du den Gambio Shop auswählen.

> **Anmerkung**
>
> Bis Version 21.1 unterAdministration → Online-Shops / Marktplätze → NEU.

UnterDetails → Schnittstellekannst du danach die entsprechenden Daten aus dem Gambio-Backend hinterlegen:

![Gambio-2.png](https://help.xentral.com/hc/article_attachments/5102255292956)

### Typische Fehlermeldungen / Probleme

xentral meldet, dass keine Aufträge im Shop vorhanden sind, obwohl welche vorhanden sein müssten. Folgende Punkte könnten die Ursache für das Problem sein:

1. Anmeldedaten fehlerhaft
  Der Importer meldet nicht zurück, dass die Anmeldedaten fehlerhaft sind. Wenn eine Anmeldung im Gambio Shop als Admin möglich ist, kannst du davon ausgehen, dass die Daten korrekt sind.

1. Fehlender Logfiles Ordner
  Bei der Installation von Gambio wurde aus irgendeinem Grund kein Logfiles Ordner angelegt. Diesen kannst du nachträglich, am Besten mit allen Rechten per FTP anlegen. Da Gambio bei der Anmeldung über die API versucht in die Logdatei in diesem Ordner zu schreiben, kommt es zu einem Fehler, der die Anmeldung scheitern lässt. Die Antwort XML enthält in diesem Fall keine SessionID und den Wortlaut:

  `...ErrorException'. with message 'file_put_contents(/var/www/vhosts/webshop.com/httpdocs/logfiles/xml.log): failed to open stream: No such file or directory in /var/www/vhosts/webshop.com/httpdocs/system/classes/gambio_xml/...`

### Schnellstart

In diesen Abschnitt erfährst du, wie du die Schnittstelle möglichst schnell zum Laufen bringst, sodass Aufträge importiert, Lagerzahlen abgeglichen und die Trackingnummern zurückgemeldet werden.

## Einstellungen für Shop oder Marktplatz

Wenn du die Einstellungen der Gambio Schnittstelle öffnest, landest du zunächst im TabDetails → Schnittstelle.

Einstellungen:

- Bezeichnung→ Name frei wählbar für den Shop (wird z.B. im Artikel und im Import-Menü angezeigt)
- Aktiv→ Haken setzen, damit die Schnittstelle aktiv ist. Nicht mehr benötigte Schnittstellen kannst du auf inaktiv setzen
- Projekt→ Verknüpfung des Shops auf ein Projekt. Im Projekt kannst du die Logistikeinstellungen vornehmen
- Abholmodus→ Bei Gambio kannst du hier ab einem bestimmten Status abholen
- Import-Modus→ Legt fest, ob die Aufträge aus dem Shop manuell (per Knopfdruck) oder automatisch importiert werden sollen
  - Demo(zum Testen) → Der Auftragsstatus im Shop nicht umgestellt, keine Artikel oder Lagerzahlen übertragen
  - Manuell(mit Importzentrale) → Die Aufträge werden erst abgeholt, wenn der ButtonAufträge abholengeklickt wird
  - Automatisch(per Prozessstarter) → Die Aufträge werden regelmäßig automatisch vom Shop abgeholt. Hierfür wird der Prozessstarter Shopimporter benötigt
- Nur 1 Auftrag pro Anfrage→ Es wird nur 1 Auftrag pro Anfrage vom Shop übertragen
- Aufträge in Zwischentabelle→ Beim Abholen der Aufträge werden die Aufträge nicht direkt angelegt, sondern erstmal zum Durchschauen in einer Zwischentabelle gespeichert. Hier kannst du entscheiden, welche Aufträge angelegt und welche erst später importiert werden sollen
- Anzahl abholen begrenzen→ Möglichkeit, um eingehende Aufträge auf einmal zu begrenzen Steht nichts (0) drin gilt die Default-Begrenzung von 100
- Protokollierung im Logfile→ Legt beim Arbeiten mit der Shop-Schnittstelle Daten zur Fehlersuche in einem Log ab
- Benutzer→ Hier musst du den Nutzer eintragen, der Zugriff auf die API hat. Meistens ein Administrator
- Passwort→ Hier musst du das entsprechende Passwort für den API Nutzer eintragen
- API Url→[https://ihreshopurl/api.php/v2](https://ihreshopurl/api.php/v2) (Bitte achte auf http oder https)
- Artikel in passende Kategorie verschieben→ Relevant für Artikelexport von xentral zum Shop Wenn nicht gesetzt wird eine Sammelkategorie in Gambio verwendet
- ID Steuerklasse Normal→ Steuerklassen gemäß Gambio Einstellung
- ID Steuerklasse Ermäßigt→ Steuerklassen gemäß Gambio Einstellung
- ID Steuerklasse Befreit→ Steuerklassen gemäß Gambio Einstellung
- Statusname Bestellung offen→ Der Name des Status im Shop, um offene Bestellungen darzustellen
- ID Bestellung in Bearbeitung → Hier trägst du die ID ein, auf welcher Gambio Bestellungen mit dem Status „in Bearbeitung“ setzt
- ID Bestellung abgeschlossen→ Hier trägst du die ID ein, auf welche Gambio Bestellungen mit dem Status „abgeschlossen“ setzt
- Datenbank Pfad→ Diese Information bekommst du bei deinem Webhoster
- Datenbank Name→ Diese Information bekommst du bei deinem Webhoster
- Datenbank Benutzer→ Diese Information bekommst du bei deinem Webhoster
- Datenbank Passwort→ Diese Information bekommst du bei deinem Webhoster
- Verbindung über ODBC herstellen→ Auswählen, wenn du die Verbindung über ODBC herstellen willst
- Abweichender ODBC Connector→ Diese Information bekommst du vom ODBC. Es gibt verschlüssselte Verbindungsmöglichkeiten zwischen der xentral Datenbank und der Shop Datenbank

Aktion:

- Verbindung prüfen→ Hier kannst du die korrekte Verbindung zu Gambio prüfen.
  Bitte beachte, dass die Verbindung nicht klappt, wenn der Shop sich im Wartungsmodus befindet

- Aufträge abholen→ Holt die Aufträge aus deinem Shop ab. Das ist notwendig, wenn du den Importmodus der Schnittstelle auf manuell gestellt hast.
- Shopimport Zwischentabelle→ Springt zur Zwischentabelle der Aufträge vom Shop. Die Zwischentabelle wird nur im manuellen Importmodus befüllt und wenn die Option 'Aufträge in Zwischentabelle' aktiviert ist.
  In der Zwischentabelle wählst du in der linken Spalte zwischen "Import", "Müll" und "Später" aus.

  - Import: Auftrag wird direkt importiert
  - Müll: Auftrag landet im Müll und kann kein zweites Mal importiert werden
  - Später: Auftrag kann zu einem späteren Zeitpunkt importiert werden
- Artikelliste abholen→ Importiert Artikel aus deinem Gambio Shop zu xentral. Shopartikel, die bereits in xentral vorhanden waren, werden aktualisiert, fehlende Artikel werden angelegt. Die Artikel werden nach dem Ausführen der Aktion nach und nach vom Prozessstarter Artikelimport abgeholt.

Andere Reiter:

Weitere Informationen zu den Einstellmöglichkeiten auf den anderen Reitern findest du unter[Online-Shops](https://help.xentral.com/hc/articles/360016756799#UUID-9f183a72-7906-0ad5-3f24-f4eeabc42c07).

Eventuell muss jeder Artikel in Gambio Informationen im Feld "Wesentliche Merkmale" besitzen. Dieses Feld kannst du durch den Artikelexport von xentral zu Gambio füllen, indem du ein Freifeld im Artikel anlegst und dieses im Freifeldermapping der Shop-Schnittstelle auf das Feld checkoutinformation mappst. Weiter unten findest du mehr Informationen zu den "Wesentliche Merkmalen".

> **Wichtig**
>
> Subshop(Subshopmapping) undGruppenmappingsind für Gambio derzeit nicht verfügbar.

## Workflows

### Aufträge an Xentral übertragen

Das Importieren von Aufträgen aus dem Shop nach Xentral wird[in diesem Artikel](https://xentral.com/helpdesk/kurzanleitung-import-von-bestellungen-aus-online-shops)beschrieben.

### Artikel nach Gambio exportieren

Die folgenden Informationen zu einem Artikel können an Gambio übertragen werden:

- Wesentliche Merkmale → Im Artikel kann in Xentral ein Freifeld angelegt werden, dessen Inhalt in das Gambio-Feld "Wesentliche Merkmale" (Kasseninformationen) übernommen wird. Gambio (Anleitung unten).
- Hersteller → Hersteller des Artikels. Wird im Shop neu angelegt, wenn im Artikel angegeben, ist aber noch nicht im Shop vorhanden.
- Herstellerlink → Herstellerlink des Artikels. Für Deutsch und Englisch wird hier der gleiche Link übertragen.
- Alternative Beschreibung des Artikelbildes → Stammt aus der Bildbeschreibung in Xentral. Der gleiche Text wird hier für Deutsch und Englisch übertragen.

#### Wesentliche Merkmale übertragen

Gambio verlangt unter Umständen, dass jeder Artikel Informationen im Feld "Wesentliche Merkmale" besitzt. Um dieses Feld durch den Artikelexport von Xentral zu Gambio zu füllen, kannst du ein Freifeld im Artikel anlegen und dieses im Freifeldermapping der Shop-Schnittstelle auf das Feld checkoutinformation mappen.

1. Du legst im Artikel ein Freifeld an und befüllst es mit den Informationen, die später im Feld "Wesentliche Merkmalen" in Gambio stehen sollen. Soll im englischen Shop ein anderer Text gezeigt werden, legst du auch eine englische Übersetzung des Freifeldes an.
1. Nun mappst du das Freifeld in der Shopschnittstelle im Tab Freifelder auf das Feld "checkoutinformation" von Gambio.
1. In Gambio erscheint nun der Inhalt des Freifeldes unter "Wesentliche Merkmale" des Artikels.

#### Export von Artikel-Eigenschaften

In xentral kannst du Artikeleigenschaften an Gambio übertragen. Dazu benötigt xentral die Datenbankzugangsdaten des Gambio-Shops, da die Gambio-API diese Funktion nicht unterstützt.

Den Datenbankpfad musst du ohne http: und ohne Port angegeben.

### Lagerzahlen synchronisieren und Aufträge importieren

Allgemeine Informationen zur Lagerzahlen Synchronisation und zum Auftagsimport findest du im folgenden Helpcenter Artikel:[Online-Shops](https://help.xentral.com/hc/articles/360016756799#UUID-9f183a72-7906-0ad5-3f24-f4eeabc42c07)

Beachte bitte, dass sich der Funktionsumfang der verschiedenen Shopanbindungen in Xentral deutlich unterscheidet. Die Shop Matrix zeigt dir detaillierte Informationen zum Funktionsumfang aller Shops. Du kannst die Shop Matrix unterShops und Marktplätze > Shop Funktioneneinsehen.

## Datenbank-Verbindung zu Gambio herstellen (für Techniker)

Für einige Features der Gambio-Schnittstelle benötigst du eine direkte Anbindung an die Datenbank des Shops, da die REST-API von Gambio diese Funktionen nicht bereitstellt.

Für folgende Funktionen wird eine Datenbankverbindung benötigt:

- Artikelexport: Eigenschaftenübertragung
- Artikelexport: Variantenartikel in korrekter Variantenstruktur übertragen
- Auftragsimport: Artikelnummer bei Varianten
- Auftragsimport: Customizer Data bei Artikeln
- Auftragsimport: Transaktionsnummer

Um deine Shopdatenbank mit xentral zu verbinden kannst du auf zwei Arten vorgehen:

- **Datenbank nach außen öffnen:** Du kannst die Datenbank des Gambio-Shops kann für den Außenzugriff öffnen. Sollte die Datenbank des Shops von außen erreichbar sein, bzw. sich im selben Netz befinden wie xentral, kannst du den Datenbankzugriff über Bordmittel realisieren. Dazu ist es ausreichend die Felder für den Datenbankzugriff entsprechend zu pflegen.
- **Veschlüsselter Zugriff auf die Datenbank über ODBC:** Falls die Shopdatenbank nicht direkt vom xentral-System aus erreichbar ist, oder ein Öffnen der Datenbank nach außen nicht gewollt oder möglich ist, kannst du stattdessen eine Verbindung über einen ODBC-Connector herstellen. Hierfür musst du neben den Datenbankzugriffsdaten noch den Pfad zum ODBC-Connector eintragen, der verwendet werden soll.

Wenn du die Daten eingetragen und gespeichert hast, kannst du durch einen Klick auf Verbindung prüfen sicherstellen, dass die Datenbankverbindung korrekt hergestellt werden kann.

Falls dein System auf der xentral Cloud installiert ist, reicht es zur Verwendung des ODBC-Connectors aus die Checkbox "Verbindung über ODBC herstellen" zu aktivieren. Auf der Cloud ist bei allen Installation der Connector bereits hinterlegt.

Ist die xentral-Installation nicht auf der Cloud gehostet, musst du den ODBC-Connector gegebenenfalls manuell installieren. Zusätzlich musst du dafür auch den lokalen Pfad zum Treiber in den Importereinstellungen hinterlegen.[Hier](https://putokaz.wordpress.com/2018/02/12/how-to-install-the-mysql-odbc-driver-on-ubuntu-16-04-or-linux-mint-18-x/)findest du eine Anleitung für ein exemplarisches Vorgehen.

Nachdem du die Einstellungen gespeichert hast, kannst du mit einem Klick auf Verbindung prüfen überprüfen, ob der Connector funktioniert. Etwaige Fehlermeldungen vom Connector werden durch den Importer direkt weitergereicht.

## Technische Dokumentation

### Status der Aufträge

Über die API werden alle Aufträge mit Order Status "1" (Im Standard ist das "offen" / Stand 12/2016) abgeholt. Die Tabelle für die Status in Gambio findet sich hier: orders_status

### Import von PayPal-Zahlungen

Wenn du aus dem Gambio-Shop Aufträge mit der Zahlungsweise PayPal importierst, beachte Folgendes:

Beim Import eines Shop-Auftrags wird folgende Transaktionsnummer mit übergeben (abhängig von der Einstellung des Shops kann eine der beiden Nummerntypen in das Feld "Transaktion" zu Xentral übernommen werden):

- PayPal: Transaktionsnummer (Transaktions-ID) → Normales PayPal Konto ohne PayPalPlus → Es wird die reguläre Transaktionsnummer übergeben, welche dann zum Kontoauszug gemapped wird (im Kontoauszug befindet sich ebenfalls die Transaktionsnummer)
- [PayPal Plus](https://xentral.com/helpdesk/kurzanleitung-paypalplus?): PAYID → PayPalPlus Konto → Es wird meist die PAYID (anstelle der regulären Transaktionsnummer) übergeben, diese wird dann zum Kontoauszug gemapped. Im Kontoauszug befindet sich die Transaktionsnummer, xentral holt parallel die PAYID über die Bankanbindung mit ab, sodass diese Nummer ein erfolgreiches Zahlungsmapping gewährleistet.